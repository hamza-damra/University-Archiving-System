<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Tree View Removal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .test-pass {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .test-fail {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>Tree View Removal Test</h1>
    <p>Testing that the tree view is properly hidden when hideTree: true is set</p>

    <div class="test-section">
        <h2>Test 1: Tree Panel Visibility</h2>
        <div id="test1-result"></div>
        <div id="fileExplorerContainer1"></div>
    </div>

    <div class="test-section">
        <h2>Test 2: Single Column Layout</h2>
        <div id="test2-result"></div>
        <div id="fileExplorerContainer2"></div>
    </div>

    <div class="test-section">
        <h2>Test 3: File List Full Width</h2>
        <div id="test3-result"></div>
        <div id="fileExplorerContainer3"></div>
    </div>

    <script type="module">
        import { FileExplorer } from '/js/file-explorer.js';

        function addResult(containerId, passed, message) {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${passed ? 'test-pass' : 'test-fail'}`;
            resultDiv.innerHTML = `<strong>${passed ? '✓' : '✗'}</strong> ${message}`;
            container.appendChild(resultDiv);
        }

        // Test 1: Verify tree panel is not rendered when hideTree: true
        try {
            const explorer1 = new FileExplorer('fileExplorerContainer1', {
                role: 'DEANSHIP',
                hideTree: true,
                readOnly: true
            });

            // Check if tree panel exists in DOM
            setTimeout(() => {
                const treePanel = document.querySelector('#fileExplorerContainer1 #fileExplorerTree');
                const treeParent = document.querySelector('#fileExplorerContainer1 .md\\:col-span-1');
                
                if (!treePanel && !treeParent) {
                    addResult('test1-result', true, 'Tree panel is not rendered (PASS)');
                } else {
                    addResult('test1-result', false, 'Tree panel found in DOM (FAIL)');
                }
            }, 100);
        } catch (error) {
            addResult('test1-result', false, `Error: ${error.message}`);
        }

        // Test 2: Verify single-column layout is used
        try {
            const explorer2 = new FileExplorer('fileExplorerContainer2', {
                role: 'DEANSHIP',
                hideTree: true,
                readOnly: true
            });

            setTimeout(() => {
                const gridContainer = document.querySelector('#fileExplorerContainer2 .grid');
                
                if (gridContainer) {
                    const hasGridCols1 = gridContainer.classList.contains('grid-cols-1');
                    const hasGridCols3 = gridContainer.classList.contains('grid-cols-3');
                    
                    if (hasGridCols1 && !hasGridCols3) {
                        addResult('test2-result', true, 'Single-column layout (grid-cols-1) is used (PASS)');
                    } else {
                        addResult('test2-result', false, `Layout classes: ${gridContainer.className} (FAIL)`);
                    }
                } else {
                    addResult('test2-result', false, 'Grid container not found (FAIL)');
                }
            }, 100);
        } catch (error) {
            addResult('test2-result', false, `Error: ${error.message}`);
        }

        // Test 3: Verify file list takes full width (no md:col-span-2)
        try {
            const explorer3 = new FileExplorer('fileExplorerContainer3', {
                role: 'DEANSHIP',
                hideTree: true,
                readOnly: true
            });

            setTimeout(() => {
                const fileListContainer = document.querySelector('#fileExplorerContainer3 #fileExplorerFileList');
                
                if (fileListContainer) {
                    const parent = fileListContainer.closest('div');
                    const hasMdColSpan2 = parent && parent.classList.contains('md:col-span-2');
                    
                    if (!hasMdColSpan2) {
                        addResult('test3-result', true, 'File list does not have md:col-span-2 class (PASS)');
                    } else {
                        addResult('test3-result', false, 'File list still has md:col-span-2 class (FAIL)');
                    }
                } else {
                    addResult('test3-result', false, 'File list container not found (FAIL)');
                }
            }, 100);
        } catch (error) {
            addResult('test3-result', false, `Error: ${error.message}`);
        }

        // Test 4: Compare with tree view enabled (control test)
        setTimeout(() => {
            const section = document.createElement('div');
            section.className = 'test-section';
            section.innerHTML = '<h2>Test 4: Control Test (Tree View Enabled)</h2><div id="test4-result"></div><div id="fileExplorerContainer4"></div>';
            document.body.appendChild(section);

            try {
                const explorer4 = new FileExplorer('fileExplorerContainer4', {
                    role: 'PROFESSOR',
                    hideTree: false,
                    readOnly: false
                });

                setTimeout(() => {
                    const treePanel = document.querySelector('#fileExplorerContainer4 #fileExplorerTree');
                    const gridContainer = document.querySelector('#fileExplorerContainer4 .grid');
                    
                    if (treePanel && gridContainer) {
                        const hasGridCols3 = gridContainer.className.includes('grid-cols-3');
                        
                        if (hasGridCols3) {
                            addResult('test4-result', true, 'Control test: Tree view is visible with 3-column layout (PASS)');
                        } else {
                            addResult('test4-result', false, 'Control test: Expected 3-column layout not found (FAIL)');
                        }
                    } else {
                        addResult('test4-result', false, 'Control test: Tree panel not found (FAIL)');
                    }
                }, 100);
            } catch (error) {
                addResult('test4-result', false, `Error: ${error.message}`);
            }
        }, 500);
    </script>
</body>
</html>
