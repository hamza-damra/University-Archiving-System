# HOD Submission Report Feature

## Overview
Enhanced the HOD dashboard with a comprehensive professor submission report that shows which professors have submitted required documents/requests. The report can be viewed in the browser and exported as a PDF.

## Features Implemented

### 1. Backend Components

#### DTOs Created
- **`ProfessorSubmissionSummary.java`**: Contains individual professor statistics
  - Total requests, submitted, pending, overdue counts
  - Completion rate and on-time rate percentages
  - Last submission date and earliest pending deadline
  
- **`DepartmentSubmissionReport.java`**: Contains department-wide report
  - Overall statistics (total professors, requests, submissions)
  - List of professor summaries
  - Generated timestamp and user info

#### Services Enhanced

**`ReportService.java`**
- `generateDepartmentSubmissionReport()`: Generates comprehensive report for HOD's department
  - Fetches all professors in the department
  - Calculates submission statistics for each professor
  - Computes overall department metrics
  - Sorts professors by completion rate

**`PdfReportService.java`** (New)
- `generateDepartmentSubmissionReportPdf()`: Generates PDF from report data
  - Professional layout with header, statistics, and detailed table
  - Color-coded statistics (blue, green, yellow, red)
  - Includes overall metrics and per-professor breakdown
  - Uses iText7 library for PDF generation

#### Controller Endpoints

**`HodController.java`** - Added two new endpoints:
- `GET /api/hod/reports/submission-summary`: Returns JSON report data
- `GET /api/hod/reports/submission-summary/pdf`: Downloads PDF report

### 2. Frontend Components

#### UI Updates
**`hod-dashboard.html`**
- Added "Professor Submission Report" section at top of dashboard
- Two action buttons:
  - **View Report**: Opens modal with interactive report
  - **Download PDF**: Downloads formatted PDF report

#### JavaScript Functionality
**`hod.js`**
- `viewReportBtn` event handler: Fetches and displays report in modal
- `downloadReportBtn` event handler: Downloads PDF and triggers browser download
- `displaySubmissionReport()`: Renders beautiful report modal with:
  - Overall statistics cards (professors, requests, submitted, pending, overdue)
  - Detailed professor table with completion progress bars
  - Color-coded metrics for easy interpretation

**`api.js`**
- Added `getSubmissionSummaryReport()`: Fetches JSON report
- Added `downloadSubmissionSummaryPdf()`: Downloads PDF file

### 3. Dependencies Added

**`pom.xml`**
- Added iText7 PDF generation library (version 7.2.5)

## Report Metrics

### Overall Statistics
- Total Professors
- Total Requests
- Total Submitted
- Total Pending
- Total Overdue
- Overall Completion Rate (%)
- Overall On-Time Rate (%)

### Per-Professor Metrics
- Professor Name & Email
- Total Requests
- Submitted Requests (with on-time/late breakdown)
- Pending Requests
- Overdue Requests
- Completion Rate (%)
- On-Time Rate (%)
- Last Submission Date
- Earliest Pending Deadline

## How to Use

### View Report in Browser
1. Log in as HOD
2. Navigate to HOD Dashboard
3. Click "View Report" button in the "Professor Submission Report" section
4. View comprehensive statistics and professor details in modal

### Download PDF Report
1. Log in as HOD
2. Navigate to HOD Dashboard
3. Click "Download PDF" button
4. PDF will be automatically downloaded with filename: `department-submission-report-[timestamp].pdf`

## Technical Details

### Report Generation Logic
- Fetches all professors in HOD's department
- For each professor:
  - Retrieves all document requests
  - Counts submitted vs pending
  - Identifies overdue requests (pending past deadline)
  - Calculates on-time vs late submissions
  - Computes completion and on-time rates
- Aggregates department-wide statistics
- Sorts professors by completion rate (descending)

### PDF Layout
- **Header**: Title, department name, generated by/date
- **Overall Statistics**: Color-coded cards with key metrics
- **Professor Table**: Detailed breakdown with 8 columns
- **Footer**: University branding

### Security
- Endpoints protected with `@PreAuthorize("hasRole('HOD')")`
- Report only shows data for HOD's assigned department
- JWT authentication required for all API calls

## Files Modified/Created

### Backend
- ✅ `ProfessorSubmissionSummary.java` (new)
- ✅ `DepartmentSubmissionReport.java` (new)
- ✅ `ReportService.java` (enhanced)
- ✅ `PdfReportService.java` (new)
- ✅ `HodController.java` (enhanced)
- ✅ `pom.xml` (updated)

### Frontend
- ✅ `hod-dashboard.html` (enhanced)
- ✅ `hod.js` (enhanced)
- ✅ `api.js` (enhanced)

## Testing Recommendations

1. **View Report**: Test with various data scenarios (all submitted, some pending, some overdue)
2. **PDF Download**: Verify PDF formatting and data accuracy
3. **Empty State**: Test with department having no professors or no requests
4. **Permissions**: Verify only HOD role can access endpoints
5. **Multi-Department**: Ensure HOD only sees their department's data

## Future Enhancements (Optional)

- Add date range filter for report
- Export to Excel format
- Email report functionality
- Schedule automatic report generation
- Add charts/graphs to visual representation
- Filter by document type or course
