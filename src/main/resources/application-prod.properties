# ============================================
# PRODUCTION CONFIGURATION (Render.com)
# ============================================
# This file contains production-specific settings
# Activate this profile with: SPRING_PROFILES_ACTIVE=prod

# Database Configuration - From Environment Variables
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DATABASE_USERNAME}
spring.datasource.password=${DATABASE_PASSWORD}

# JPA/Hibernate Configuration - Production
# Use 'update' for initial deployment, then switch to 'validate' with migrations
spring.jpa.hibernate.ddl-auto=${HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
# Disable open-in-view for better performance in production
spring.jpa.open-in-view=false

# Connection Pooling - Production Optimized
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# Flyway Migration - DISABLED (using Hibernate ddl-auto instead)
spring.flyway.enabled=false

# SQL initialization - disabled in prod
spring.sql.init.mode=never

# Session Configuration - Production
spring.session.timeout=60m
spring.session.jdbc.cleanup-cron=0 0 * * * *

# File Upload Settings - Production
# Allow up to 100MB per file and larger total request size for multiple files
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=1000MB

# Application Upload Configuration - Production (Render Disk)
app.upload.base-path=${UPLOAD_PATH:/var/data/uploads/}
app.upload.allowed-extensions=pdf,doc,docx,ppt,pptx,xls,xlsx,txt,zip,rar,jpg,jpeg,png,gif,csv
app.upload.max-file-count=10
app.upload.max-total-size-mb=1000
app.upload.create-directories=true

# Low-level file upload limits (used by FolderFileUploadServiceImpl)
# 100MB in bytes
file.max-size=104857600

# JWT Configuration - Production (from environment)
# SECURITY: JWT_SECRET must be set - no default value in production
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:86400000}

# CORS Configuration - Production
# SECURITY: Must be set to your production domain(s)
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS}

# Server Configuration - Production (Render uses PORT env var)
server.port=${PORT:8080}
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain

# Logging Configuration - Production (console only for Render)
# Reduced logging for performance, only WARN and ERROR messages
logging.level.root=WARN
logging.level.com.alquds.edu.ArchiveSystem=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Keep-Alive Configuration (prevents Render free tier cold starts)
app.keep-alive.enabled=${KEEP_ALIVE_ENABLED:true}
app.keep-alive.url=${KEEP_ALIVE_URL:}

# ============================================
# SECURITY NOTES
# ============================================
# 1. Always use environment variables for sensitive data (DB_USERNAME, DB_PASSWORD, JWT_SECRET)
# 2. Never commit production credentials to version control
# 3. Use strong, randomly generated JWT secret (minimum 256 bits)
# 4. Ensure SSL/TLS is enabled for database connections
# 5. Review and update security settings regularly
# 6. Monitor logs for suspicious activity
# 7. Keep all dependencies up to date

